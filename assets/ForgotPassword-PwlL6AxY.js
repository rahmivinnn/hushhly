import{u as J,a as U,r as d,j as r,X as W}from"./index-BnT946GU.js";import{I as j}from"./input-Cq4gGQzI.js";import{B as k}from"./button-B6LXQo29.js";import{L as E}from"./label-D8Q-p73C.js";import{A as X}from"./arrow-left-BQRj5OLm.js";import{M as Z}from"./mail-ByWqmZ7a.js";import{C as G}from"./circle-alert-CMFHS_dH.js";class w{constructor(t=0,s="Network Error"){this.status=t,this.text=s}}const Q=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},n={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:Q()},N=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},ee=(e,t="https://api.emailjs.com")=>{if(!e)return;const s=N(e);n.publicKey=s.publicKey,n.blockHeadless=s.blockHeadless,n.storageProvider=s.storageProvider,n.blockList=s.blockList,n.limitRate=s.limitRate,n.origin=s.origin||t},C=async(e,t,s={})=>{const i=await fetch(n.origin+e,{method:"POST",headers:s,body:t}),a=await i.text(),m=new w(i.status,a);if(i.ok)return m;throw m},R=(e,t,s)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||typeof t!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!s||typeof s!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},te=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},B=e=>e.webdriver||!e.languages||e.languages.length===0,F=()=>new w(451,"Unavailable For Headless Browser"),se=(e,t)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof t!="string")throw"The BlockList watchVariable has to be a string"},re=e=>{var t;return!((t=e.list)!=null&&t.length)||!e.watchVariable},ie=(e,t)=>e instanceof FormData?e.get(t):e[t],H=(e,t)=>{if(re(e))return!1;se(e.list,e.watchVariable);const s=ie(t,e.watchVariable);return typeof s!="string"?!1:e.list.includes(s)},I=()=>new w(403,"Forbidden"),ae=(e,t)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&typeof t!="string")throw"The LimitRate ID has to be a non-empty string"},oe=async(e,t,s)=>{const i=Number(await s.get(e)||0);return t-Date.now()+i},V=async(e,t,s)=>{if(!t.throttle||!s)return!1;ae(t.throttle,t.id);const i=t.id||e;return await oe(i,t.throttle,s)>0?!0:(await s.set(i,Date.now().toString()),!1)},D=()=>new w(429,"Too Many Requests"),ne=async(e,t,s,i)=>{const a=N(i),m=a.publicKey||n.publicKey,f=a.blockHeadless||n.blockHeadless,g=a.storageProvider||n.storageProvider,h={...n.blockList,...a.blockList},x={...n.limitRate,...a.limitRate};return f&&B(navigator)?Promise.reject(F()):(R(m,e,t),te(s),s&&H(h,s)?Promise.reject(I()):await V(location.pathname,x,g)?Promise.reject(D()):C("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:m,service_id:e,template_id:t,template_params:s}),{"Content-type":"application/json"}))},le=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ce=e=>typeof e=="string"?document.querySelector(e):e,de=async(e,t,s,i)=>{const a=N(i),m=a.publicKey||n.publicKey,f=a.blockHeadless||n.blockHeadless,g=n.storageProvider||a.storageProvider,h={...n.blockList,...a.blockList},x={...n.limitRate,...a.limitRate};if(f&&B(navigator))return Promise.reject(F());const u=ce(s);R(m,e,t),le(u);const p=new FormData(u);return H(h,p)?Promise.reject(I()):await V(location.pathname,x,g)?Promise.reject(D()):(p.append("lib_version","4.4.1"),p.append("service_id",e),p.append("template_id",t),p.append("user_id",m),C("/api/v1.0/email/send-form",p))},me={init:ee,send:ne,sendForm:de,EmailJSResponseStatus:w},ue="YOUR_PUBLIC_KEY";me.init(ue);const _=()=>Math.floor(1e3+Math.random()*9e3).toString(),y={},pe=async e=>{try{const t=_();return y[e]={code:t,timestamp:Date.now()+10*60*1e3},console.log(`OTP for ${e}: ${t}`),await new Promise(s=>setTimeout(s,1e3)),{success:!0,otp:t}}catch(t){return console.error("Error sending OTP email:",t),{success:!1,error:"Failed to send OTP email. Please try again."}}},he=(e,t)=>{const s=y[e];if(!s)return!1;if(s.timestamp<Date.now())return delete y[e],!1;const i=s.code===t;return i&&delete y[e],i},fe=async(e,t)=>{try{await new Promise(i=>setTimeout(i,1e3));const s=JSON.parse(localStorage.getItem("user")||"{}");return s.password=t,localStorage.setItem("user",JSON.stringify(s)),!0}catch(s){return console.error("Error resetting password:",s),!1}},L={sendOTPEmail:pe,verifyOTP:he,resetPassword:fe,generateOTP:_},Ne=()=>{const e=J(),{toast:t}=U(),[s,i]=d.useState(!1),[a,m]=d.useState(""),[f,g]=d.useState(!1),[h,x]=d.useState(["","","",""]),[u,p]=d.useState(""),[ge,M]=d.useState(!1),[T,P]=d.useState(""),[K,A]=d.useState(""),[q,Y]=d.useState(0),[v,O]=d.useState(0);d.useEffect(()=>{let o;return v>0&&(o=setInterval(()=>{O(c=>c-1)},1e3)),()=>{o&&clearInterval(o)}},[v]);const S=async o=>{if(o.preventDefault(),!a){t({title:"Email required",description:"Please enter your email address",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)){t({title:"Invalid email",description:"Please enter a valid email address",variant:"destructive"});return}i(!0),P("");try{const l=await L.sendOTPEmail(a);if(l.success&&l.otp){A(l.otp);const b=Date.now()+10*60*1e3;Y(b),O(60),M(!0),i(!1),t({title:"OTP sent",description:"Check your email for the verification code"}),g(!0),t({title:"Demo Mode: Your OTP",description:`Your OTP code is: ${l.otp}`,duration:1e4})}else P(l.error||"Failed to send OTP. Please try again."),i(!1),t({title:"Error",description:l.error||"Failed to send OTP. Please try again.",variant:"destructive"})}catch(l){console.error("Error sending OTP:",l),P("An unexpected error occurred. Please try again."),i(!1),t({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}},$=(o,c)=>{if(c.length>1)return;const l=[...h];if(l[o]=c,x(l),c&&o<3){const b=document.getElementById(`otp-${o+1}`);b&&b.focus()}},z=async o=>{o.preventDefault();const c=h.join("");if(c.length!==4){t({title:"Invalid OTP",description:"Please enter all 4 digits",variant:"destructive"});return}if(Date.now()>q){t({title:"OTP Expired",description:"The verification code has expired. Please request a new one.",variant:"destructive"});return}if(!u){t({title:"Password required",description:"Please enter your new password",variant:"destructive"});return}if(u.length<6){t({title:"Weak Password",description:"Password must be at least 6 characters long",variant:"destructive"});return}i(!0);try{c===K?await L.resetPassword(a,u)?(i(!1),t({title:"Password reset successful",description:"Your password has been reset"}),setTimeout(()=>{e("/sign-in")},1500)):(i(!1),t({title:"Error",description:"Failed to reset password. Please try again.",variant:"destructive"})):(i(!1),t({title:"Invalid OTP",description:"The verification code you entered is incorrect",variant:"destructive"}))}catch(l){console.error("Error resetting password:",l),i(!1),t({title:"Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}};return r.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[r.jsx("div",{className:"flex items-center px-4 py-6",children:r.jsx("button",{onClick:()=>e("/sign-in"),className:"p-2 text-black hover:bg-gray-100 rounded-full transition-colors",children:r.jsx(X,{size:20})})}),r.jsxs("div",{className:"flex-1 flex flex-col items-center px-8",children:[r.jsx("div",{className:"mb-6",children:r.jsx("img",{src:"/lovable-uploads/cc8b384e-95bb-4fbf-af3b-70bbc53bfd59.png",alt:"Hushhly Logo",className:"w-40 h-auto"})}),r.jsx("h1",{className:"text-2xl font-bold mb-2 text-center",children:"Forgot Password"}),r.jsx("p",{className:"text-gray-500 mb-8 text-center text-sm px-6",children:"Enter your email address and we'll send you a verification code"}),r.jsxs("form",{onSubmit:S,className:"w-full max-w-md space-y-6",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(E,{htmlFor:"email",children:"Email"}),r.jsx(j,{id:"email",type:"email",placeholder:"Enter your email",value:a,onChange:o=>m(o.target.value),className:"h-12 rounded-xl"})]}),r.jsx(k,{type:"submit",disabled:s||f,className:"w-full h-12 bg-gradient-to-r from-meditation-lightBlue to-meditation-mediumBlue hover:bg-meditation-mediumBlue text-white font-medium rounded-xl",children:s?"Sending...":"Send OTP Code"}),r.jsxs("p",{className:"text-center text-sm",children:["Remember your password?"," ",r.jsx("span",{onClick:()=>e("/sign-in"),className:"text-meditation-lightBlue cursor-pointer hover:underline",children:"Sign in"})]})]}),f&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:r.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md relative animate-fade-in-up",children:[r.jsx("button",{onClick:()=>g(!1),className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700",children:r.jsx(W,{size:20})}),r.jsx("div",{className:"flex items-center justify-center mb-4",children:r.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:r.jsx(Z,{size:24,className:"text-meditation-lightBlue"})})}),r.jsx("h2",{className:"text-xl font-bold mb-2 text-center",children:"Verify OTP"}),r.jsx("p",{className:"text-gray-500 mb-2 text-center text-sm",children:"Enter the 4-digit code sent to"}),r.jsx("p",{className:"text-meditation-lightBlue font-medium mb-6 text-center",children:a}),T&&r.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4 flex items-start",children:[r.jsx(G,{size:18,className:"text-red-500 mr-2 mt-0.5"}),r.jsx("p",{className:"text-red-600 text-sm",children:T})]}),r.jsxs("form",{onSubmit:z,className:"space-y-6",children:[r.jsx("div",{className:"flex justify-center space-x-2",children:h.map((o,c)=>r.jsx(j,{id:`otp-${c}`,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:o,onChange:l=>$(c,l.target.value),className:"h-14 w-14 text-center text-xl font-bold rounded-xl",maxLength:1,autoFocus:c===0},c))}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(E,{htmlFor:"new-password",children:"New Password"}),r.jsx(j,{id:"new-password",type:"password",placeholder:"Enter new password (min. 6 characters)",value:u,onChange:o=>p(o.target.value),className:"h-12 rounded-xl"})]}),r.jsx(k,{type:"submit",disabled:s,className:"w-full h-12 bg-gradient-to-r from-meditation-lightBlue to-meditation-mediumBlue hover:bg-meditation-mediumBlue text-white font-medium rounded-xl",children:s?"Resetting...":"Reset Password"}),r.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Didn't receive the code?"," ",v>0?r.jsxs("span",{className:"text-gray-400",children:["Resend in ",v,"s"]}):r.jsx("span",{onClick:S,className:"text-meditation-lightBlue cursor-pointer hover:underline",children:"Resend"})]}),r.jsx("div",{className:"text-center text-xs text-gray-400 mt-2",children:"OTP will expire in 10 minutes"})]})]})})]}),r.jsx("div",{className:"relative h-24 mt-4",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1440 320",className:"absolute bottom-0 left-0 w-full",preserveAspectRatio:"none",children:r.jsx("path",{fill:"#33C3F0",fillOpacity:"0.2",d:"M0,96L48,112C96,128,192,160,288,165.3C384,171,480,149,576,128C672,107,768,85,864,96C960,107,1056,149,1152,165.3C1248,181,1344,171,1392,165.3L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"})})})]})};export{Ne as default};
//# sourceMappingURL=ForgotPassword-PwlL6AxY.js.map
