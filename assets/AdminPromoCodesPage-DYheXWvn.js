import{r as l,j as e,J as d}from"./index-BnT946GU.js";import{B as x}from"./button-B6LXQo29.js";import{I as o}from"./input-Cq4gGQzI.js";import{p as N}from"./promoCodeService-8OR0XIRB.js";import{u as w}from"./useAuthSimple-7TrV8nxw.js";import"./tslib.es6-De9GV7Vy.js";const S=()=>{const[p,c]=l.useState([]),[b,h]=l.useState(!0),[m,j]=l.useState(!1),{user:g}=w(),[s,u]=l.useState({code:"",description:"",discount:"",subscriptionTiers:["Any"],discountType:"percentage",discountValue:0,duration:"one-time"});l.useEffect(()=>{(async()=>{try{h(!0);const a=await N.getAllPromoCodes();c(a)}catch(a){console.error("Error loading promo codes:",a),d.error("Failed to load promo codes")}finally{h(!1)}})()},[]);const n=t=>{const{name:a,value:i}=t.target;u(r=>({...r,[a]:i}))},f=t=>{u(a=>{const i=[...a.subscriptionTiers],r=i.indexOf(t);return r===-1?i.push(t):i.splice(r,1),{...a,subscriptionTiers:i}})},v=async t=>{if(t.preventDefault(),!g){d.error("You must be logged in to add promo codes");return}try{const a=[];s.maxUses&&a.push({type:"maxUses",value:s.maxUses}),s.startDate&&s.endDate&&a.push({type:"dateRange",value:{startDate:new Date(s.startDate),endDate:new Date(s.endDate)}}),s.userType&&a.push({type:"userType",value:s.userType}),s.userTag&&a.push({type:"userTag",value:s.userTag}),s.userAction&&a.push({type:"userAction",value:s.userAction});const i={code:s.code.toUpperCase(),description:s.description,discount:s.discount,subscriptionTiers:s.subscriptionTiers,isActive:!0,discountType:s.discountType,discountValue:Number(s.discountValue),duration:s.duration,durationValue:s.durationValue?Number(s.durationValue):void 0,conditions:a,createdAt:new Date,updatedAt:new Date};c(r=>[...r,{id:`promo_${Date.now()}`,...i}]),u({code:"",description:"",discount:"",subscriptionTiers:["Any"],discountType:"percentage",discountValue:0,duration:"one-time"}),j(!1),d.success("Promo code added successfully")}catch(a){console.error("Error adding promo code:",a),d.error("Failed to add promo code")}},y=(t,a)=>{c(i=>i.map(r=>r.id===t?{...r,isActive:!a}:r)),d.success(`Promo code ${a?"deactivated":"activated"}`)};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Promo Codes Management"}),e.jsx(x,{onClick:()=>j(!m),children:m?"Cancel":"Add New Promo Code"})]}),m&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Promo Code"}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Code"}),e.jsx(o,{name:"code",value:s.code,onChange:n,placeholder:"e.g. SUMMER2025",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx(o,{name:"description",value:s.description,onChange:n,placeholder:"e.g. Summer Sale 2025",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Discount Display Text"}),e.jsx(o,{name:"discount",value:s.discount,onChange:n,placeholder:"e.g. 25% off for 3 months",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Discount Type"}),e.jsxs("select",{name:"discountType",value:s.discountType,onChange:n,className:"w-full p-2 border rounded",required:!0,children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed Amount"}),e.jsx("option",{value:"free",children:"Free"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Discount Value"}),e.jsx(o,{name:"discountValue",type:"number",value:s.discountValue,onChange:n,placeholder:"e.g. 25 (for 25%)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration"}),e.jsxs("select",{name:"duration",value:s.duration,onChange:n,className:"w-full p-2 border rounded",required:!0,children:[e.jsx("option",{value:"one-time",children:"One-time"}),e.jsx("option",{value:"days",children:"Days"}),e.jsx("option",{value:"months",children:"Months"}),e.jsx("option",{value:"lifetime",children:"Lifetime"})]})]}),(s.duration==="days"||s.duration==="months")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration Value"}),e.jsx(o,{name:"durationValue",type:"number",value:s.durationValue||"",onChange:n,placeholder:"e.g. 3 (for 3 months)",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Uses"}),e.jsx(o,{name:"maxUses",type:"number",value:s.maxUses||"",onChange:n,placeholder:"Leave empty for unlimited"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Valid From"}),e.jsx(o,{name:"startDate",type:"date",value:s.startDate||"",onChange:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Valid Until"}),e.jsx(o,{name:"endDate",type:"date",value:s.endDate||"",onChange:n})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Type"}),e.jsxs("select",{name:"userType",value:s.userType||"",onChange:n,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"Any"}),e.jsx("option",{value:"new",children:"New Users"}),e.jsx("option",{value:"existing",children:"Existing Users"}),e.jsx("option",{value:"inactive",children:"Inactive Users"}),e.jsx("option",{value:"beta",children:"Beta Users"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Tag"}),e.jsx(o,{name:"userTag",value:s.userTag||"",onChange:n,placeholder:"e.g. parent, new_mom, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"User Action"}),e.jsxs("select",{name:"userAction",value:s.userAction||"",onChange:n,className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"referral",children:"Referral"}),e.jsx("option",{value:"cancellation",children:"Cancellation"}),e.jsx("option",{value:"paired_signup",children:"Paired Signup"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Applicable Plans"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Any","Monthly","Annual","Family Plan","Sleep Plan","Premium"].map(t=>e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:s.subscriptionTiers.includes(t),onChange:()=>f(t),className:"mr-1"}),t]},t))})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(x,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Add Promo Code"})})]})]}),b?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-2 border-blue-500 border-t-transparent mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading promo codes..."})]}):e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Discount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plans"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[p.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium",children:t.code}),e.jsx("td",{className:"px-6 py-4",children:t.description}),e.jsx("td",{className:"px-6 py-4",children:t.discount}),e.jsx("td",{className:"px-6 py-4",children:t.subscriptionTiers.join(", ")}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx(x,{variant:"ghost",className:t.isActive?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800",onClick:()=>y(t.id,t.isActive),children:t.isActive?"Deactivate":"Activate"})})]},t.id)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"No promo codes found. Add your first promo code!"})})]})]})})]})};export{S as default};
//# sourceMappingURL=AdminPromoCodesPage-DYheXWvn.js.map
