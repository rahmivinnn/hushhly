import{J as d}from"./index-BnT946GU.js";const l="hushhly_user_balance",m=1e3,u={getUserBalance(a){try{const t=localStorage.getItem(l);if(t){const r=JSON.parse(t);if(r[a])return r[a]}const e={userId:a,balance:m,currency:"USD",lastUpdated:Date.now(),transactions:[]};return this.saveUserBalance(a,e),e}catch(t){return console.error("Error getting user balance:",t),{userId:a,balance:m,currency:"USD",lastUpdated:Date.now(),transactions:[]}}},saveUserBalance(a,t){try{const e=localStorage.getItem(l);let r={};e&&(r=JSON.parse(e)),r[a]={...t,lastUpdated:Date.now()},localStorage.setItem(l,JSON.stringify(r))}catch(e){console.error("Error saving user balance:",e),d.error("Gagal menyimpan data saldo")}},async addBalance(a,t,e){try{const r=this.getUserBalance(a),n={id:`TRX${Date.now()}${Math.floor(Math.random()*1e3)}`,amount:t,type:"credit",description:e,timestamp:Date.now(),status:"pending"};r.transactions.unshift(n),this.saveUserBalance(a,r),await new Promise(o=>setTimeout(o,1500));const c=this.getUserBalance(a),s=c.transactions.findIndex(o=>o.id===n.id);return s!==-1?(c.transactions[s].status="completed",c.balance+=t,this.saveUserBalance(a,c),window.dispatchEvent(new Event("balance-updated")),!0):!1}catch(r){return console.error("Error adding balance:",r),d.error("Gagal menambah saldo"),!1}},async deductBalance(a,t,e,r){try{const n=this.getUserBalance(a);if(n.balance<t)return{success:!1,error:"Saldo tidak mencukupi"};const c={id:`TRX${Date.now()}${Math.floor(Math.random()*1e3)}`,amount:t,type:"debit",description:e,timestamp:Date.now(),status:"pending",paymentMethod:r};n.transactions.unshift(c),this.saveUserBalance(a,n),await new Promise(i=>setTimeout(i,2e3));const s=this.getUserBalance(a),o=s.transactions.findIndex(i=>i.id===c.id);return o!==-1?(s.transactions[o].status="completed",s.balance-=t,this.saveUserBalance(a,s),window.dispatchEvent(new Event("balance-updated")),{success:!0,transaction:s.transactions[o]}):{success:!1,error:"Gagal memproses transaksi"}}catch(n){return console.error("Error deducting balance:",n),{success:!1,error:n instanceof Error?n.message:"Gagal mengurangi saldo"}}},getTransactionHistory(a){try{return this.getUserBalance(a).transactions}catch(t){return console.error("Error getting transaction history:",t),[]}},formatBalance(a,t="USD"){try{return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}catch(e){return console.error("Error formatting balance:",e),`${t} ${a}`}}};export{u as b};
//# sourceMappingURL=balanceService-BrshoRSL.js.map
